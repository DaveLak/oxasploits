<html>
<head>
    <title>NEXO-OS</title>

    <link rel="stylesheet" type="text/css" href="static/ext-4.2/resources/css/nexo.css">

    <link rel="shortcut icon" href="static/favicon.ico" />

    <script type="text/javascript" src="static/BS350.js"></script>
    <script type="text/javascript" src="static/app/base64.js"></script>
    <script type="text/javascript">var USER='{{=user}}';var BCOLOR='{{=bcolor}}';var TITLE='{{=title}}'</script>
    <script type="text/javascript">
        Ext.onReady(function() {
          var viewport = Ext.create('Ext.container.Viewport', {
            style: { background: BCOLOR },
            layout:
            {
              type : 'vbox',
              pack: 'center',
              align: 'center'
            },
            items: [
              {
                xtype: 'form',
                title: TITLE,
                width: 240,
                height: 80,
                bodyPadding: 10,
                items: [
                  {
                    xtype: 'textfield',
                    name: 'password',
                    inputType: 'password',
                    labelWidth: 70,
                    fieldLabel: 'Password',
                    listeners: {
                      specialkey: function(field, e) {
                        if (e.getKey() == e.ENTER) {
                          this.up('form').doLogin();
                        }
                      }
                    }
                  }
                ],
                doLogin : function()
                {
                  var me = this;
                  var values = me.getValues();
                  var token = Base64.encode(USER+':'+ values['password']);
                  Ext.Ajax.request({
                    url: 'BS350/default/loginAuth/login',
                    headers: {
                      Authorization : 'Basic ' + token
                    },
                    params: {
                      lang: values['lang']
                    },
                    success: function(response, opts) {
                      if (response.responseText == 'ok')
                      {
                        window.location = './index';
                      }
                      else
                      {
                        me.down('textfield').setValue('');
                      }
                    },
                    failure: function(response, opts) {
                      // IE can not handle this. Use only for debugging purposes:
                      // console.log('server-side failure with status code ' + response.status);
                    }
                  });
                }
              }
            ]
          });

          viewport.render(Ext.getBody());
        });
    </script>
</head>
<body>
    <noscript><img src="static/images/warning.png" alt="Javascript not enabled" /><big>Javascript not enabled. Please enable it to use the application.</big></noscript>
</body>
</html>
