<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>Torque Unit Test</title>
</head>
    <link rel="stylesheet" type="text/css" href="../../static/ext-4.2/resources/css/nexo.css">
    <link rel="stylesheet" type="text/css" href="../../static/app/BS350.css">
<script type="text/javascript">
    var mediaVersion = "{{=mediaVersion}}";
</script>
<script src="../../static/ext-4.2/ext-all-dev.js"/>
<script type="application/javascript">

</script>
<script type="application/javascript">
    Ext.Loader.setConfig({enabled: true, paths: { 'BS350': '../../static/app' } });
    Ext.require('BS350.custom.Torque');
    Ext.require('BS350.custom.Utils');
    utils = Ext.create('BS350.custom.Utils');
    Ext.getClass(utils).initEnv();

    TR = function(txt) {return txt};

    Ext.application({
        name: 'BS350',
        appFolder: '../../static/app',

        launch: function() {
          console.log('applaunch');
          APP = this;
          var torqueStore = Ext.create('Ext.data.Store', {
            fields: ['nm', 'ftlb', 'inlb', 'kpm', 'nm2ftlb2nm', 'nm2inlb2nm', 'nm2kpm2nm'],
              data:{ 'items': []},
              proxy: {
                  type: 'memory',
                  reader: {
                      type: 'json',
                      root: 'items'
                  }
              }
          });
            var i;
            var prec = 4;
            for (i = 0.001; i < 10; i = i + 0.001) {
                var t1 = Ext.create('BS350.custom.Torque', {value: i, unit: 0});
                var t2 = Ext.create('BS350.custom.Torque', {value: i, unit: 0});
                var t3 = Ext.create('BS350.custom.Torque', {value: i, unit: 0});
                var t4 = Ext.create('BS350.custom.Torque', {value: i, unit: 0});
                var t5 = Ext.create('BS350.custom.Torque', {value: i, unit: 0});
                var t6 = Ext.create('BS350.custom.Torque', {value: i, unit: 0});
                var t7 = Ext.create('BS350.custom.Torque', {value: i, unit: 0});
                //console.log("FTLB", t.convert("FTLB").value);
                var precision = 4;
                torqueStore.add({
                    'nm': t1.getRoundedValByUnit(),
                    'ftlb': t2.convert("FTLB").getRoundedValByUnit(),
                    'inlb': t3.convert("INLB").getRoundedValByUnit(),
                    'kpm': t4.convert("KPM").getRoundedValByUnit(),
                    'nm2ftlb2nm': t5.convert("FTLB").round().convert("NM").getRoundedValByUnit(),
                    'nm2inlb2nm': t6.convert("INLB").round().convert("NM").getRoundedValByUnit(),
                    'nm2kpm2nm': t7.convert("KPM").round().convert("NM").getRoundedValByUnit()
                });
            }
          var v = Ext.create('Ext.container.Viewport', {
              layout: 'fit',
              items: [
                  {
                      xtype: 'panel',
                      layout: {type: 'vbox', packs: 'start', align: 'stretch'},
                      items: [
                          {
                              xtype: 'panel',
                              layout: {type: 'hbox'},
                              items: [
                                  {
                                      xtype: 'textfield',
                                      fieldLabel: "Nm max valida.",
                                      readOnly: true,
                                      value: 1000
                                  },
                                  {
                                      xtype: 'textfield',
                                      fieldLabel: "Ftlb max valida.",
                                      readOnly: true,
                                      value: Ext.Number.toFixed((1000 * BS350.custom.Torque.FTLB), 2)
                                  },
                                  {
                                      xtype: 'textfield',
                                      fieldLabel: "Inlb max valida.",
                                      readOnly: true,
                                      value: Ext.Number.toFixed((1000 * BS350.custom.Torque.INLB), 2)
                                  },
                                  {
                                      xtype: 'textfield',
                                      fieldLabel: "kpm/kgfm/kgm max valida.",
                                      labelWidth: 180,
                                      readOnly: true,
                                      value: Ext.Number.toFixed((1000 * BS350.custom.Torque.KPM), 2)
                                  }
                              ]
                          },
                          {
                              xtype: 'panel',
                              layout: {type: 'hbox'},
                              items: [
                                  {
                                      xtype: 'textfield',
                                      fieldLabel: "Nm precision",
                                      readOnly: true,
                                      value: BS350.custom.Torque.UNIT2PREC[0]
                                  },
                                  {
                                      xtype: 'textfield',
                                      fieldLabel: "Ftlb precision",
                                      readOnly: true,
                                      value: BS350.custom.Torque.UNIT2PREC[1]
                                  },
                                  {
                                      xtype: 'textfield',
                                      fieldLabel: "Inlb precision",
                                      readOnly: true,
                                      value: BS350.custom.Torque.UNIT2PREC[2]
                                  },
                                  {
                                      xtype: 'textfield',
                                      fieldLabel: "kpm/kgfm/kgm precision",
                                      labelWidth: 180,
                                      readOnly: true,
                                      value: BS350.custom.Torque.UNIT2PREC[3]
                                  }
                              ]
                          },
                          {
                              xtype: 'grid',
                              autoscroll: true,
                              store: torqueStore,
                              columns: [
                                  {text: 'Nm', dataIndex: 'nm'},
                                  {text: 'Ftlb', dataIndex: 'ftlb'},
                                  {text: 'Inlb', dataIndex: 'inlb'},
                                  {text: 'kpm', dataIndex: 'kpm'},
                                  {
                                      text: 'Nm 2 Ftlb 2 Nm', dataIndex: 'nm2ftlb2nm',
                                      renderer: function (val, rec) {
                                          if (rec.record.get('nm') !== rec.record.get('nm2ftlb2nm')) {
                                              return "<div style='color: #ff0000;'>" + rec.record.get('nm2ftlb2nm') + "</div>";
                                          }
                                          return rec.record.get('nm2ftlb2nm');
                                      }
                                  },
                                  {
                                      text: 'Nm 2 Inlb 2 Nm', dataIndex: 'nm2inlb2nm',
                                      renderer: function (val, rec) {
                                          if (rec.record.get('nm') !== rec.record.get('nm2inlb2nm')) {
                                              return "<div style='color: #ff0000;'>" + rec.record.get('nm2inlb2nm') + "</div>";
                                          }
                                          return rec.record.get('nm2inlb2nm');
                                      }
                                  },
                                  {
                                      text: 'Nm 2 kpm 2 Nm', dataIndex: 'nm2kpm2nm',
                                      renderer: function (val, rec) {
                                          if (rec.record.get('nm') !== rec.record.get('nm2kpm2nm')) {
                                              return "<div style='color: #ff0000;'>" + rec.record.get('nm2kpm2nm') + "</div>";
                                          }
                                          return rec.record.get('nm2kpm2nm');
                                      }
                                  }
                              ]
                          }
                      ]
                  }
              ]
          });
        }
    });


</script>
<body>

</body>
</html>
