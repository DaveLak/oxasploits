import fsio
import FilePaths
from operator import itemgetter

__author__ = 'frank.sattelberger@bittwister.com'


def get_torque_unit_factors_choice(facts):
    facts = sorted(facts, key=itemgetter('Id'))
    res = []
    for fac in facts:
        res.append([str(fac['Id']), fac['Einheit']])
    return res


def get_torque_unit_factors_map(facts):
    facts = sorted(facts, key=itemgetter('Id'))
    res = {}
    for fac in facts:
        res[fac['Id']] = fac['Einheit']
    return res


def get_torque_unit_factors():
    channel = fsio.jsonload(FilePaths.CHAN_CONF_FILENAME)
    ed = channel.get('EinheitDrehmoment')
    ed['edAddedChoice'] = get_torque_unit_factors_choice(ed.get('Faktoren'))
    return ed


def raw_load_torque_factors():
    channel = fsio.jsonload(FilePaths.CHAN_CONF_FILENAME)
    facts = channel.get('EinheitDrehmoment').get('Faktoren')
    return facts


def load_torque_unit_factors_choice():
    facts = raw_load_torque_factors()
    return get_torque_unit_factors_choice(facts)


def load_torque_unit_map():
    facts = raw_load_torque_factors()
    return get_torque_unit_factors_map(facts)
